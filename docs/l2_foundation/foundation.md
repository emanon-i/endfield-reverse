---
status: done
---

# endfield-reverse システム構成

## 1. 技術スタック

### 1.1 フロントエンド

| 技術 | バージョン | 選定理由 |
|------|-----------|---------|
| React | 18.x | データソース（endfield-calc）と同一。型定義・データ構造を直接流用可能 |
| TypeScript | 5.x | 型安全性確保。レシピ・アイテムデータの複雑な型を明示的に管理 |
| Vite | 5.x | 高速なHMR、シンプルな設定、React公式推奨 |
| Zustand | 4.x | 軽量（3KB）、ボイラープレートなし、状態管理がシンプル |

### 1.2 スタイリング

| 技術 | 選定理由 |
|------|---------|
| Tailwind CSS | ユーティリティファースト、カスタマイズ容易、データソースと同一 |

### 1.3 バックエンド

**なし** - クライアントサイドのみで完結

- 全計算ロジックはブラウザ内で実行
- データは静的にバンドル（JSONまたはTS定数）

### 1.4 インフラ

| 項目 | 選定 | 選定理由 |
|------|------|---------|
| ホスティング | GitHub Pages | 無料、シンプル、GitHubリポジトリと直接連携 |
| CI/CD | GitHub Actions | GitHub Pagesへの自動デプロイ |
| CDN | GitHub Pages内蔵 | 追加設定不要 |

## 2. アーキテクチャ

### 2.1 コンポーネント構成図

```
┌─────────────────────────────────────────────────────────────┐
│                        Browser                              │
├─────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────┐  │
│  │                    React App                          │  │
│  ├───────────────────────────────────────────────────────┤  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │  │
│  │  │  OreInput   │  │ ItemSelect  │  │ PlanOutput  │   │  │
│  │  │  Component  │  │  Component  │  │  Component  │   │  │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘   │  │
│  │         │                │                │          │  │
│  │         └────────────────┼────────────────┘          │  │
│  │                          │                           │  │
│  │                   ┌──────▼──────┐                    │  │
│  │                   │    State    │                    │  │
│  │                   │  (Zustand)  │                    │  │
│  │                   └──────┬──────┘                    │  │
│  │                          │                           │  │
│  │                   ┌──────▼──────┐                    │  │
│  │                   │  Calculator │                    │  │
│  │                   │   Engine    │                    │  │
│  │                   └──────┬──────┘                    │  │
│  │                          │                           │  │
│  │                   ┌──────▼──────┐                    │  │
│  │                   │  Game Data  │                    │  │
│  │                   │  (Static)   │                    │  │
│  │                   └─────────────┘                    │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 データフロー

```
鉱石レート入力 ──► 最大生産量計算 ──► アイテム一覧表示
                                          │
                                          ▼
                              ユーザーがアイテム選択
                                          │
                                          ▼
                              残りリソース再計算
                                          │
                                          ▼
                              選択可能アイテム更新
                                          │
                                          ▼
                               生産計画出力
```

### 2.3 ディレクトリ構成

endfield-calcの構成を参考に、更新追従しやすい構造を採用。

```
endfield-reverse/
├── docs/                      # Tri-SSD仕様書
│   ├── l1_requirements/
│   ├── l2_foundation/
│   └── l3_phases/
├── src/
│   ├── data/                  # ゲームデータ（endfield-calcから流用）
│   │   ├── recipes.ts
│   │   ├── items.ts
│   │   └── facilities.ts
│   ├── types/                 # 型定義（必要分のみ流用）
│   │   └── index.ts
│   ├── lib/                   # 計算ロジック（独自実装）
│   │   └── calculator.ts
│   ├── components/            # UIコンポーネント（フラット構成）
│   ├── hooks/                 # カスタムフック
│   ├── store/                 # Zustand store
│   │   └── useCalculatorStore.ts
│   ├── App.tsx
│   └── main.tsx
├── public/
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
├── tailwind.config.js
└── README.md
```

**設計方針:**
- `data/`, `types/`, `lib/` はendfield-calcと同じ構成 → 更新追従が容易
- `components/` はフラット構成 → 小規模プロジェクトにはネスト不要
- `store/` でZustandの状態管理を集約

## 3. 非機能要求

### 3.1 性能

| 項目 | 目標値 |
|------|--------|
| 初回ロード | < 3秒（3G回線想定） |
| 計算応答 | < 100ms（再計算時） |
| バンドルサイズ | < 500KB（gzip後） |

### 3.2 対応環境

| 項目 | 対象 |
|------|------|
| ブラウザ | Chrome, Firefox, Safari, Edge（最新2バージョン） |
| デバイス | デスクトップ優先、モバイル対応 |

### 3.3 データ管理

- **ライセンス準拠**: endfield-calc（MITライセンス）の著作権表示を維持
- **データ更新**: 上流リポジトリの更新時に手動で同期

## 4. 用語集

| 用語 | 定義 |
|------|------|
| AIC | Automated Industry Complex（自動工業施設）。ゲーム内の工場システム |
| 鉱石 | フィールドで採取する基本素材（源石鉱、紫晶鉱、青鉄鉱、銅鉱） |
| レシピ | 素材から成果物を生産するための設備・時間・素材量の定義 |
| 設備 | レシピを実行する機械（採掘機、精錬炉、組立機など） |
| 採取レート | 単位時間あたりの鉱石採取量（個/分） |
| 生産レート | 単位時間あたりの成果物生産量（個/分） |

## 5. 採用しなかった選択肢

### 5.1 フレームワーク

| 選択肢 | 不採用理由 |
|--------|-----------|
| Vue | データソースがReactのため、型定義流用が困難 |
| Svelte | 同上。また、Reactエコシステムの恩恵を受けられない |
| Next.js | SSR/SSG不要。静的サイトにはオーバースペック |

### 5.2 ホスティング

| 選択肢 | 不採用理由 |
|--------|-----------|
| Vercel | Next.js最適化が不要。GitHub Pagesで十分 |
| Cloudflare Pages | Workers連携不要。シンプルさを優先 |

### 5.3 状態管理

| 選択肢 | 不採用理由 |
|--------|-----------|
| Redux | 小規模アプリには過剰 |
| React Context | 計算→再計算の連鎖的な状態更新でZustandの方がシンプルに書ける |
| Jotai | 複雑な依存関係がないため、Zustandで十分 |
