---
status: done
---

# endfield-reverse ビジョン・要求ドキュメント

## 1. プロダクトの目的・背景

### 1.1 解決したい課題・ペイン

アークナイツ エンドフィールドの工場生産（AIC: Automated Industry Complex）システムにおいて、フィールドで採取する鉱石素材がボトルネックとなる。プレイヤーは限られた鉱石供給の中で、売却品・装備素材・消費財など複数の成果物を効率的に生産したいが、既存ツールは「目標成果物 → 必要素材を逆算」するアプローチしか提供していない。

**本ツールが解決する問い:**

- 既存ツール: 「これを作りたい、何が必要？」
- 本ツール: 「この素材量で何が作れる？」（**逆方向のアプローチ**）

### 1.2 想定ユーザー／ペルソナ

- アークナイツ エンドフィールドのプレイヤー
- 工場生産（AIC）を効率化したいユーザー
- 限られた鉱石リソースを最大限活用したいユーザー

### 1.3 ビジネス上のゴール

鉱石の採取レート（個/分）を入力として、作成可能な成果物の組み合わせをインタラクティブに選択し、最終的な生産計画を出力するツールを提供する。

---

## 2. 制約条件・前提

### 2.1 動作環境

Webアプリケーション（ブラウザで動作）

### 2.2 法規制・コンプライアンス

該当なし

### 2.3 外部システム連携

- **データソース**: [JamboChen/endfield-calc](https://github.com/JamboChen/endfield-calc)（MITライセンス）
  - `src/data/recipes.ts` - 全レシピデータ
  - `src/data/items.ts` - アイテムマスタ
  - `src/data/facilities.ts` - 設備データ

---

## 3. 機能要求一覧

### 鉱石採取レート入力

- **ID**: REQ-20260205-001
- **優先度**: 高

鉱石の採取レート（個/分）を入力できる。対象鉱石:

- 源石鉱（Originium Ore）
- 紫晶鉱（Amethyst Ore）
- 青鉄鉱（Ferrium Ore）
- 銅鉱（Cuprium Ore）※後半解放・水中採掘

### 作成可能アイテム算出

- **ID**: REQ-20260205-002
- **優先度**: 高

入力された鉱石量から「作成可能なアイテム一覧」と各アイテムの「最大生産量（個/分）」を算出・表示する。連鎖レシピ展開（REQ-20260206-001）により、中間素材から最終製品まで全段階のアイテムが対象となる。

### インタラクティブ選択・再計算

- **ID**: REQ-20260205-003
- **優先度**: 高

ユーザーがアイテムと生産量を選択すると、鉱石消費を計算し、残りリソースで作れるものを再計算する。選択可能なアイテムが減っていくインタラクティブな体験を提供する。中間素材も選択対象となり、選択した中間素材は下流の最終製品の素材として利用可能となる。

### 生産計画出力

- **ID**: REQ-20260205-004
- **優先度**: 高

選択した生産リスト（アイテム名 × 生産量/分）と必要な設備台数を出力する。最終製品だけでなく、中間素材の生産に必要な設備も含めて出力する。

### 設備数・面積算出

- **ID**: REQ-20260205-005
- **優先度**: 中

各設備の必要台数と最低必要マス数（設備サイズ × 台数の合計）を算出する。
※コンベア・分岐・合流のレイアウトは計算対象外

### 制約フィルタ

- **ID**: REQ-20260205-006
- **優先度**: 低

以下の制約でフィルタリングできる:

- 電力上限
- AICスペース上限
- 解放済みレシピのみ表示

### 連鎖レシピ展開

- **ID**: REQ-20260206-001
- **優先度**: 高

鉱石から最終製品までのレシピツリーを構築し、全段階のアイテムを「作成可能アイテム一覧」に表示する。現在の「直接変換のみ」から、中間素材を経由した全レシピに拡張する。

例：

- 源石鉱 → 結晶殻 → 結晶パウダー → ...
- 青鉄鉱 → 鉄塊 → 鉄コンポーネント → ...

### 複数入力レシピ対応

- **ID**: REQ-20260206-002
- **優先度**: 高

2種類以上の素材を入力とするレシピ（61個）に対応する。全ての入力素材が供給可能な場合のみ「作成可能」と判定し、最大生産量は全入力の制約を満たす最小値となる。

例：

- 瓶詰め食品: ガラスボトル(5) + パウダー(5) → 瓶詰め(1)
- ボトル供給10個/分、パウダー無限 → 最大2個/分（ボトルで制限）

### ボトルネック表示

- **ID**: REQ-20260206-003
- **優先度**: 中

選択したアイテムの生産量を制限している素材（ボトルネック）を表示する。ユーザーが「なぜこの生産量なのか」を理解し、最適化のヒントを得られるようにする。

表示例：「ボトルネック: ガラスボトル（10個/分で制限）」

### 複数ルート選択

- **ID**: REQ-20260206-004
- **優先度**: 低

同一アイテムに複数の生産ルートがある場合、ユーザーが選択できる。

例：結晶殻の生産ルート

- ルートA: 源石鉱 → 結晶殻（精錬炉）
- ルートB: 結晶パウダー → 結晶殻（精錬炉）

---

## 4. 非機能要求

### データ管理

- レシピデータはEndfield Calc（MITライセンス）から流用
- 著作権表示とライセンス文の記載が必要
- 上流リポジトリの更新に追従 or 手動対応

### 計算仕様

- 時間単位: 分ベース（ゲーム内表記に準拠）
- 効率の定義: 鉱石をロスなく使い切るレーン効率
- 複数レシピ: 同一素材に複数レシピがある場合は同列表示、ユーザー選択

### MVP前提条件

- スペース: 無限
- 電力: 無限
- 草系素材（蕎花・サンドリーフ等）: 工場内栽培により無限供給可能として扱う
- レシピ: 全解放状態

---

## 5. 参考・類似サービス

### データソース（流用元）

- [JamboChen/endfield-calc (GitHub)](https://github.com/JamboChen/endfield-calc) - MITライセンス

### 既存ツール

- [Endfield Calc](https://jambochen.github.io/endfield-calc/) - 数値計算特化
- [EndfieldLab](https://endfield-calc.github.io/) - 機械数・リソース要件
- [EndfieldTools](https://endfieldtools.dev/factory-planner/) - ビジュアルプランナー
- [AKEF-AIC-Calculator](https://micro215.github.io/AKEF-AIC-Calculator/) - 複数レシピ対応

### 攻略サイト

- [Game8 エンドフィールド攻略](https://game8.jp/arknights-endfield)
- [GameWith エンドフィールド攻略](https://gamewith.jp/akendfield/)
- [アルテマ エンドフィールド攻略](https://altema.jp/akendfield/)
